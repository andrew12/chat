<html>
<head>
  <title>insert title</title>
  <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>
  $(function() {
    function callback() {
      socket.emit("update", { name: $('#name').val(),
                              text: $('#text').val() });
    }

    $('#name').keyup(callback);
    $('#text').keyup(callback);

    socket = io.connect('/');

    socket.on('update', function (data) {
      $('tr[socket_id=' + data.id + ']').find('.name').html(data.name);
      $('tr[socket_id=' + data.id + ']').find('.text').html(data.text);
    });

    socket.on('new', function(data) {
      $('table').append("<tr socket_id=" + data.id + "><th class=name></th><td class=text></td></tr>")
    });

    socket.on('remove', function(data) {
      $('tr[socket_id=' + data.id + ']').remove();
    });
  });
  </script>

  <style>
  table, input, textarea, .text { width: 100%; }
  textarea {
    font-family: monospace;
    height: 300px;
  }
  </style>
</head>
<body>
  <table border=1 cellpadding=5 cellspacing=0>
  </table>
  <div id="input">
    <p>
      <input type="text" id="name" value="name" />
      <br />
      <textarea id="text">edit me!</textarea>
    </p>
  </div>
</body>
</html>
